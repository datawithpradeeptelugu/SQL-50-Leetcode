PATTERN:
FIXED WINDOW -AVG,SUM CALCULATION
AGGREAGE TABLE-CTE AS PARENT TABLE


SQL COMPONENTS:

1)DAILY AMOUNT - SUM,GROUP BY IN CTE
2)RUNNING SUM - SUM(COLUMN) OVER (ORDER BY TIME ROWS BETWEEN 'N'
PRECEDING AND CURRENT ROW)
3)RUNNING AVG- AVG(COLUMN) OVER (ORDER BY TIME ROWS BETWEEN 'N'
PRECEDING AND CURRENT ROW)
4)7 DAYS WINDOW DATE -OFFSET 6(SKIP WHICH DATES HAVE 7 DAYS FRAME)