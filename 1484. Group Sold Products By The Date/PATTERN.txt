PATTERN:

1)DISTINCT DATE LEVEL PRODUCTS:
USE CTE TO GET DISTINCT  PRODUCTS AT SELL_DATE LEVEL EARLY


2)WITH IN GROUP LEVEL VALUE COMMA SEPERATED VALUE

#STRING_AGG(COLUMN_NAME,',')  -- THIS IS FOR COMMA SEPERATED VALUE


#WITH IN GROUP IF WE WANT SORTING 
WE HAVE TO USE STRING_AGG(COLUMN_NAME,',')  ALONG WITH 
-WITHIN GROUP(ORDER BY COLUMN_NAME ASC/DESC)